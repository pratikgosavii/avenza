{% extends "partials/vendorBase.html" %}
{% load static %}

{% block title %}Vendor Profile{% endblock title %}

{% block extra_css %}
<link href="{% static 'libs/admin-resources/jquery.vectormap/jquery-jvectormap-1.2.2.css' %}" rel="stylesheet" type="text/css" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
<style>
    body {
        background-color: #f9f9f9;
        font-family: Arial, sans-serif;
    }

    .profile-container {
        background-color: white;
        border: 2px solid #291a4a;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .profile-header {
        text-align: center;
        margin-bottom: 20px;
    }

    .profile-image {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid #f0d28c;
    }

    .upload-note {
        font-size: 12px;
        color: gray;
        margin-top: 5px;
    }

    .form-label {
        font-weight: bold;
        color: #291a4a;
    }

    .btn-primary {
        background-color: #291a4a;
        border-color: #291a4a;
    }

    .btn-primary:hover {
        background-color: #f0d28c;
        color: #291a4a;
    }

    .submit-btn-container {
        text-align: center;
        margin-top: 20px;
    }

    .dropdown-menu {
        max-height: 300px; /* Set the maximum height of the dropdown */
        overflow-y: auto; /* Enable vertical scrolling */
    }


</style>
{% endblock extra_css %}

{% block content %}
<div class="main-content">
    <div class="page-content">
        <div class="container-fluid">

            <!-- Profile Container -->
            <div class="profile-container">
                <div class="profile-header">
                    {% if vendor.image %}
                    <img
                        id="image"
                        class="profile-image"
                        src="{{ vendor.image.url }}"
                        alt="{{ vendor.vendorname }} Profile"
                    />
                {% else %}
                    <img
                        id="profileImage"
                        class="profile-image"
                        src="https://via.placeholder.com/150"  
                        alt="{{ vendor.vendorname }} Profile"
                    />
                {% endif %}
                    <p class="upload-note"></p>
                </div>
                <form method="POST" action="{% url 'VendorDetails' %}" enctype="multipart/form-data">

                    {% csrf_token %}

                    <label for="image_vendor" class="form-label">Upload Profile Image</label>

                    <div class="card-body">
                        <input type="file" class="form-control" 
                        id="image_vendor" name="image" 
                        multiple 
                        onchange="displaySelectedImages()" />
                        <div class="mt-3" id="selectedImages" style="display: flex; gap: 10px; flex-wrap: wrap"></div>
                    </div>
    
                    




                        <!-- Update Portfolio Link -->
                        <div class="mb-3">
                            <label for="portfolio_link" class="form-label">Portfolio Link</label>
                            <input
                                type="url"
                                id="portfolio_link"
                                name="portfolio_link"
                                class="form-control"
                                value="{{ vendor.portfolio_link }}"
                            />
                            <small class="text-muted">Enter your portfolio URL (optional).</small>
                        </div>
                    
                    <!-- Success/Error Messages -->
                    <!-- {% if success %}
                        <div class="alert alert-success">{{ success }}</div>
                    {% elif error %}
                        <div class="alert alert-danger">{{ error }}</div>
                    {% endif %} -->
                    
                    <!-- Update Name -->
                    <div class="mb-3">
                        <label for="vendorname" class="form-label">Name*</label>
                        <input
                            type="text"
                            id="vendorname"
                            name="vendorname"
                            class="form-control"
                            value="{{ vendor.vendorname }}"
                            required
                        />
                    </div>

                    <!-- Update Phone -->
                    <div class="mb-3">
                        <label for="vendorPhoneNumber" class="form-label">Phone*</label>
                        <input
                            type="text"
                            id="vendorPhoneNumber"
                            name="vendorPhoneNumber"
                            class="form-control"
                            value="{{ vendor.vendorPhoneNumber }}"
                            required
                        />
                    </div>


                    <label for="service" class="form-label">Services</label>
                    <div class="dropdown">
                      <button
                        class="btn btn-secondary dropdown-toggle w-100"
                        type="button"
                        id="serviceDropdown"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                      >
                        Select Services
                      </button>
                      <ul class="dropdown-menu w-100" aria-labelledby="serviceDropdown">
                      
                        {% for i in Categories %}
                      
                        <li>
                          <label class="dropdown-item">
                            <input
                              type="checkbox"
                              name="categories"
                              class="form-check-input me-2"
                              {% if i in vendor.category.all %} checked {% endif %}
                              value="{{ i.id }}"
                            />
                            {{ i }}
                          </label>
                        </li>
        
                        {% endfor %}
                      </ul>
                    </div>



                  
                    <!-- Submit Button -->
                    <div class="submit-btn-container">
                        <button type="submit" class="btn btn-primary">Update Profile</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock content %}





{% block extra_js %}


<script>


    function displaySelectedImages() {
        const input = document.getElementById("image_vendor");
        const selectedImagesContainer = document.getElementById("selectedImages");
        selectedImagesContainer.innerHTML = ""; // Clear previously displayed images
    
        Array.from(input.files).forEach((file) => {
          if (file.type.startsWith("image/")) {
            const reader = new FileReader();
            reader.onload = (event) => {
              const imageDiv = document.createElement("div");
              imageDiv.style.position = "relative";
              const img = document.createElement("img");
              img.src = event.target.result;
              img.alt = file.name;
              img.style.width = "100px";
              img.style.height = "100px";
              img.style.objectFit = "cover";
              img.style.border = "1px solid #ddd";
              img.style.borderRadius = "5px";
              imageDiv.appendChild(img);
              selectedImagesContainer.appendChild(imageDiv);
            };
            reader.readAsDataURL(file);
          }
        });
      }
    
      
  
</script>

{% endblock extra_js %}



